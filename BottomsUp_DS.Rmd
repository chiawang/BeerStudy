---
title: "Stroud_DataCamp"
author: "David Stroud"
date: "2/19/2018"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library(psych)
library(dplyr) # Heavy use of this library
```

```{r}
Beers <- read.csv('Beers.csv')
Breweries <- read.csv('Breweries.csv')
```

```{r}
# Renamed Brewery_id to Brew_ID to satisfy merging requirement
Beers <- rename(Beers, Brew_ID = Brewery_id)
```

```{r}
# dplyr library used to make data easier to work with.
dplyr::tbl_df(Beers)
dplyr::tbl_df(Breweries)
```

```{r}
BrewPub <- full_join(Beers, Breweries, by="Brew_ID")
dplyr::tbl_df(BrewPub)
```


```{r}
head(BrewPub,6)
tail(BrewPub,6)
```
```{r}
BrewPub %>%
  group_by(State) %>%
  summarize(max_size = max(ABV, na.rm = TRUE))
```


```{r}
MissingValues <- sapply(BrewPub, function(x)sum(is.na(x)))
print(MissingValues)
```

```{r}
BrewPub %>%
  group_by(State) %>%
  summarise(count = n_distinct(Brew_ID))
```



```{r}
# Do we need to place NA with 0 or ignore?
# Could be non-alcoholic beer
Bitter <- BrewPub %>%
  na.omit() %>%
group_by(State) %>%
summarise(Median = median(ABV)) %>%
arrange(Median)
dplyr::tbl_df(Bitter)
```

```{r}
FireWater <- BrewPub %>%
  na.omit() %>%
group_by(State) %>%
summarise(Median = median(IBU)) %>%
arrange(Median)
dplyr::tbl_df(FireWater)
```

  

```{r}
ggplot(data=FireWater, aes(x=State, y=Median)) +
  geom_bar(stat="identity", fill="steelblue")+
  theme_minimal() +
  theme(axis.text.x=element_text(size=rel(0.8), angle=90)) +
  ggtitle("Median IBU by State") +
  labs(x="State",y="IBU")
```

```{r}
ggplot(data=Bitter, aes(x=State, y=Median)) +
  geom_bar(stat="identity", fill="steelblue")+
  theme_minimal() +
  theme(axis.text.x=element_text(size=rel(0.8), angle=90))+
  ggtitle("Median ABV by State") +
  labs(x="State",y="ABV")
  
```

```{r}
# Which state has the maximum alcoholic (ABV) beer?
BrewPub[which.max(BrewPub$ABV),]
```

```{r}
# Which state has the most bitter (IBU) beer?
BrewPub[which.max(BrewPub$IBU),]
```

```{r}
# Combine Bitterness of Beer and Alcohol Content df for ease of analysis
BitterFire <- full_join(FireWater, Bitter, by="State")
dplyr::tbl_df(BitterFire)
```

```{r}
# Change column names to reflect meaningful variable name
BitterFire$Median.x <- (BitterFire$Median.x)
dplyr::tbl_df(BitterFire)
```

```{r}
# 
ggplot(BitterFire, aes(x=Median.x, y= Median.y)) +
  geom_point(shape=1) +
   geom_smooth(method=lm) + # add linear regression line
  theme(axis.text.x=element_text(size=rel(1.0)))+
ggtitle("Correlation between IBU and ABV ") +
  labs(x="IBU",y="ABV")
```

```{r}
BitterFire.lm = lm(Median.y~ Median.x, data=BitterFire)
summary(BitterFire.lm)
```


